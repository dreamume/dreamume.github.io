---
layout:     post
title:      "Weekly 039"
subtitle:   "Algorithm: ; Review: digital video introduction, How does a video codec work; Share: Primality Tests"
thumbnail-img: ""
date:       2021-04-16 10:00
author:     "dreamume"
tags: 		[it]
category:   it
---
<head>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [['$','$']]
            }
        });
    </script>
</head>

# Table of Contents

1.  [Algorithm](#org5fabb1b)
2.  [Review](#org18ccb2f)
3.  [Tips](#orgebc9586)
4.  [Share](#orgeace7e3)
    1.  [费马测试](#org7aab4bb)
    2.  [Miller-Rabin测试](#org7af13c2)


<a id="org5fabb1b"></a>

# Algorithm

Leetcode 365: 


<a id="org18ccb2f"></a>

# Review

digital video introduction

<https://github.com/leandromoreira/digital_video_introduction#intro>


<a id="orgebc9586"></a>

# Tips

-   


<a id="orgeace7e3"></a>

# Share

Primality Tests

<https://crypto.stanford.edu/pbc/notes/numbertheory/millerrabin.html>

给定一个整数n，如何确定n是一个素数？假设n是一个奇数

最明显的想法是对n做因式分解，但目前还没有有效的因式分解算法


<a id="org7aab4bb"></a>

## 费马测试

根据费马定理，如果n是一个素数，则对任意a有 $ a^{n-1} = 1 (mod \\, n) $。费马测试建议：随机取一个数 $ a \\in [1 \\ldots n - 1] $看是否 $ a^{n-1} = 1 (mod \\, n) $。如果不是，则n不是一个素数

然而，当n不为素数时等式也可能成立。例如，n = 561 = 3 x 11 x 17。通过中国余数定理

$ \\mathcal{Z}_ {561} = \\mathcal{Z}_ {3} \\times \\mathcal{Z}_ {11} \\times \\mathcal{Z}_ {17} $

对每个 $ a \\in \\mathcal{Z}^{ * }_ {561} $对应有

$ (x, y, z) \\in \\mathcal{Z}^{ * }_ {3} \\times \\mathcal{Z}^{ * }_ {11} \\times \\mathcal{Z}^{ * }_ {17} $

通过费马定理，$ x^{2} = 1, y^{10} = 1, z^{16} = 1 $。因为2，10和16都能被260整除，这意味着 $ (x, y, z)^{560} = (1, 1, 1) $，即 $ \\forall a \\in \\mathcal{Z}^{ * }_ {561}, a^{560} = 1 $

这样不管我们选择什么样的a值，561总是能通过费马测试，只要a与n互质就行。这样的数称为Carmichael数，且它有无穷多个

如果a不与n互质，则不能通过费马测试，但这种情况下我们可通过计算gcd(a, n) 获得n的一个因子


<a id="org7af13c2"></a>

## Miller-Rabin测试

我们可通过n是素数当且仅当 $ x^{2} = 1 (mod \\, n) $ 的解为 $ x = \\pm 1 $来获得更好的处理

如果n通过费马测试，则 $ a^{n-1} = 1 $，则我们检查 $ a^{\\frac{n-1}{2}} = \\pm 1 $，因为 $ a^{\\frac{n-1}{2}} $是1的平方根

不幸地是，有些数比如第三个Carmichael数1729依然会通过这个加强版的测试。但如果我们迭代进行测试呢？我们继续把指数减半测试直到模的结果不是1。如果其结果不是-1则n不是素数

更形式化的，设 $ 2^{s} $为n - 1中包含2最大的指数，即 $ n - 1 = 2^{s}q $，q为某个奇数。序列的每个成员

$ a^{n-1} = a^{2^{s}q}, a^{2^{s - 1}q}, \\cdots, a^{q} $

是连续的平方根

如果n是素数，该序列模结果开始为1且要么每个成员为1，或第一个不为1的结果为-1

Miller-Rabin测试随机取 $ a \\in \\mathcal{Z}_ {n} $，如果上述序列模结果不以1开始，或第一个不为1的结果不是-1，则n不是一个素数

它证明对任意组合数n，包括Carmichael数，n通过Miller-Rabin测试的可能性最多为 $ \\frac{1}{4} $。（平均概率会小很多）这样n通过的可能性在几次运行后指数级减少

如果n没通过Miller-Rabin测试，但序列模结果开始为1，则我们有一个模n为1的平方根，我们可有效因式分解n。这样Carmichael数总是很容易分解

练习：如果我们用Miller-Rabin测试对这样形式的数pq，q和q都是很大的素数，会怎么样？我么能用它来破解RSA吗？

给定一个n，找到s使得 $ n - 1 = 2^{s}q $，q为某个奇数，然后我们实现一个Miller-Rabin测试如下：

1.  随机选择一个数 $ a \\in [1 \\ldots n - 1] $
2.  如果 $a^{q} = 1 $则n通过
3.  否则，对 $ i = 0, \\ldots, s - 1 $看是否 $ a^{2^{i}q} = -1 $，如果这样，n通过
4.  否则n不是一个素数
