---
layout:     post
title:      "Weekly 078"
subtitle:   "Algorithm: Smallest Rotation with Highest Score; Review: Timelines at Scale; Tips: ; Share: "
thumbnail-img: ""
date:       2023-07-29 19:30
author:     "dreamume"
tags: 		[it]
category:   it
---
<head>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [['$','$']]
            }
        });
    </script>
</head>

# Table of Contents

1.  [Algorithm](#org20078c5)
2.  [Review](#orgdea5f31)
3.  [Tips](#orgf6e77d4)
4.  [Share](#orge8bd447)


<a id="org20078c5"></a>

# Algorithm

Leetcode 798: [Smallest Rotation with Highest Score](https://leetcode.com/problems/smallest-rotation-with-highest-score)

<https://dreamume.medium.com/leetcode-798-smallest-rotation-with-highest-score-f83dbd4cea9>


<a id="orgdea5f31"></a>

# Review

[Timelines at Scale](https://www.infoq.com/presentations/Twitter-Timeline-Scalability/)

Twitter 工程师 Raffi Krikorian 讲述了 Twitter 使用的架构处理美妙数千个事件。根据听力和 Slide 记录下相关内容

Twitter 当时面临的挑战是：

1.  1 亿 5 千万的活跃用户
2.  时间线上 30 万 QPS
3.  本地时间线的题材提取慢

Fanout 模块中主要是 Social Graph Service，其主要功能是插入接收者、一次流水线 4 千个目标和复制

使用 Redis 作为时间线缓存

使用 Blender 作搜索，Earlybird 模块做搜索索引服务，针对用户发布一条消息，Redis 需要写 n 次，用户读取则 Redis 需要读 1 次，而相对于搜索，写时需要 1 次，读取会有 n 次

第二个挑战是：

1.  fanout 服务真的很慢
2.  特别对有高的关注者账号

这一块没太听懂，似乎是如果是高关注度用户的话通过搜索来查询最新的消息，这样避免通过 fanout 服务导致过慢的结果

Tweet input:

-   每天 ~4 亿条推特
-   每日平均每秒 ~5K
-   每日高峰时每秒 ~7K
-   大事件时每秒大于 12K

一些监测工具观察跟踪相关行为


<a id="orgf6e77d4"></a>

# Tips


<a id="orge8bd447"></a>

# Share

