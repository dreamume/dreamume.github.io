---
layout:     post
title:      "Weekly 076"
subtitle:   "Algorithm: Minimize the Total Price of the Trips; Review: The Design of a Practical System for Fault-Tolerant Virtural Machines; Tips: ; Share: "
thumbnail-img: ""
date:       2023-06-12 11:30
author:     "dreamume"
tags: 		[it]
category:   it
---
<head>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [['$','$']]
            }
        });
    </script>
</head>

# Table of Contents

1.  [Algorithm](#org9d238bf)
2.  [Review](#org4b07b6c)
    1.  [简介](#org18f7d2e)
3.  [Tips](#org99a30f9)
4.  [Share](#orgcf41ef1)


<a id="org9d238bf"></a>

# Algorithm

Leetcode 2646: [Minimize the Total Price of the Trips](https://leetcode.com/problems/minimize-the-total-price-of-the-trips/)

<https://dreamume.medium.com/leetcode-2646-minimize-the-total-price-of-the-trips-48d4e9401d23>


<a id="org4b07b6c"></a>

# Review

[The Design of a Practical System for Fault-Tolerant Virtural Machines](https://pdos.csail.mit.edu/6.824/papers/vm-ft.pdf)

我们已实现了一个商业企业级系统提供容错虚拟机，基于在另一台服务器上通过后台虚拟机复制主虚拟机的执行的方式。我们已在 VMware vSphere 4.0 上设计了一个完整的系统，其易使用，运行在商业服务器上且典型地减少实际应用程序 10% 的性能。另外，对几个真实的应用程序，数据带宽需要在主和副虚拟机上执行 lockstep 保持少于 20 Mbit/s，允许长距离容错实现的可能性。一个容易使用，故障后自动恢复冗余的商业系统在复制虚拟机执行上需要许多额外的组件。我们设计和实现了这些额外的组件和在运行企业级应用程序支持的虚拟机上处理许多实际的问题。在本文中，我们描述我们的基本设计，讨论替代设计选择和一些实现细节，且提供微评测和实际的应用程序的性能结果


<a id="org18f7d2e"></a>

## 简介

一个通常的实现容错服务器的方案时主/备份方式，一个备份服务器在主服务器故障时总是有效地进行接管。备份服务器的状态必须保存在所有时刻对主服务器是确定的，这样当主服务器故障时备份服务器可立刻接管，且这样故障对外部客户隐藏且没有数据丢失。在备份服务器上复制状态的一个方法是移植主服务器的所有状态改变，包括 CPU，内存和 I/O 设备，在备份服务器几乎连续地处理。然而，发送这个状态的带宽，特别是内存的改变，可能会非常大

一个不同的办法是复制服务器使用更少的带宽有时作为一种状态机方案。想法是模型服务器作为一个确定性状态机从相同的初始化状态开始保持同步且确保它们以相同的顺序接收到相同的输入请求。因为多数服务器或服务有一些操作是不确定性的，一些额外的条件需要使用来确保一个主服务器和备份服务器同步。然而，保持主服务器和备份服务器同步的额外信息的总数远小于主服务器改变的状态总数（主要是内存更新）

实现协调来确保确定性物理服务器执行是困难的，特别是作为处理器频率的增加。相反地，一个运行在 hypervisor 上的虚拟机是实现状态机方案的优秀平台。一个虚拟机可考虑为一个良好定义的状态机，其操作是虚拟的机器操作（包括所有它的设备）。作为一个物理服务器，虚拟机有一些非确定性操作（例如，读一个时钟或转发一个中断），且这样额外的信息必须被发送到备份服务器来确保它已同步。因为 hypervisor 有对虚拟机执行的完全控制，包括转发所有输入，hypervisor 能够抓获在主虚拟机上非确定性操作的所有必要的信息且在备份虚拟机上正确地重放这些操作

因此，状态机方案可在基于商业硬件在虚拟机上实现，不需要硬件修改，允许对最新的处理器立即地容错。另外，对状态机方案的低带宽要求允许主服务器和备份服务器的更大的物理隔离的可能性。例如，复制的虚拟机可运行在跨校园的分布式物理机上，提供比相同建筑里运行的虚拟机更多的可靠性

我们以主/备份方式在 VMware vSphere 4.0 平台上实现了容错，其以一个高效地方式运行完全的 x86 虚拟机。因为 VMware vSphere 实现了一个完整的 x86 虚拟机，我们能对任意 x86 操作系统和应用程序自动提供容错。基本的技术允许我们记录主服务器的执行且确保备份服务器知道确定性的回放。VMware vSphere 容错基于确定性的回放，但添加了必要的额外信息和功能来构建一个完整的容错系统。为了提供硬件容错，我们的系统自动在一个故障后恢复容错，通过在本地簇上任意有效的服务器上开启一个新的备份虚拟机。这时，确定性回放和 VMware FT 的产品版本只支持单处理器虚拟机。在多处理器虚拟机上记录和回放执行仍然在研发中，由于几乎每个访问恭喜内存都可能是一个非确定性操作导致对性能有显著的影响

Bressoud 和 Schneider 描述了一个 HP-RISC 平台容错虚拟机的原型实现。我们的处理相似，但我们因性能原因和一些替代性设计有一些基本上的不同。另外，我们设计和实现了系统许多额外的组件且处理一些实际问题来构建一个完整系统，使其高效且对运行企业级应用程序的用户有用。同其他实际系统讨论相似，我们只尝试处理故障停止故障，即服务器故障在导致一个不正确额外可见行为前可被检测

本文的后续组织如下。首先，我们描述我们的基本设计和我们基本协议细节确保一个备份虚拟机在主虚拟机故障后接管不会有数据丢失。然后，我们详细描述许多必须处理的实际问题来构建一个健壮，完整和自动化系统。我们也描述一些实现虚拟机容错的设计选择和讨论这些选择的妥协。接着，我们对我们的实现在一些评测和一些实际的企业级应用程序上给出性能结果。最后，我们描述相关工作


<a id="org99a30f9"></a>

# Tips


<a id="orgcf41ef1"></a>

# Share

