---
layout:     post
title:      "Weekly 041"
subtitle:   "Algorithm: Fliptile; Review: A Response to Cheriton and Skeen's Criticism of Causual and Totally Ordered Communication; Tips: Probability Theory in Principles of Discrete Applied Mathematics; Share: Binary Decision Diagrams"
thumbnail-img: ""
date:       2021-06-08 09:00
author:     "dreamume"
tags: 		[it]
category:   it
---
<head>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [['$','$']]
            }
        });
    </script>
</head>

# Table of Contents

1.  [Algorithm](#org5011220)
2.  [Review](#org3706cb2)
    1.  [背景](#org04b7e81)
    2.  [实际中的经验](#org537de57)
3.  [Tips](#org9574eb8)
    1.  [采样空间和事件](#org78514ce)
    2.  [条件概率和独立](#org809e364)
4.  [Share](#org63e202f)
    1.  [Families and ZDDs](#org85770dc)
    2.  [References](#org4b7cf33)


<a id="org5011220"></a>

# Algorithm

Fliptile: <http://poj.org/problem?id=3279>

<https://dreamume.medium.com/poj-fliptile-d3138796c111>


<a id="org3706cb2"></a>

# Review

A Response to Cheriton and Skeen's Criticism of Causual and Totally Ordered Communication

<https://www.cs.princeton.edu/courses/archive/fall07/cos518/papers/catocs-limits-response.pdf>


<a id="org04b7e81"></a>

## 背景

在给1993 ACM操作系统理论专题研讨会上的论文中，Cheriton和Skeen提供了他们对于无关和总序作为通讯属性的理解。在这篇文章中，我想要展现我在Isis上的工作，及Isis采用的通讯模型。我假设读者熟悉Cheriton Sheen的论文，且他们使用的并发顺序的结构

Isis不是Cheriton和Skeen讨论的使用无关和总序属性的唯一的系统，还有很多项目的研究者使用相似的技术。然而，我将主要介绍Isis，当我阅读Cheriton/Skeen的讨论，它似乎显示在他们的论文中使用CATOCS作为其同义词

我想要做几个主要论点：

-   虽然以学术术语呈现，Skeen和Cheriton在系统中有一个商机称为TIB $ (tm)<sup>2</sup> $，其和Isis分布式工具(tm)及Isis分布式新系统(tm)是竞争关系。这样，在他们想法的背后有一个商业产品。我提及这个不是对他们论文的指责，而是提供一个利益冲突。Cheriton和Skeen使用他们的观点来赚钱，但贬低Isis产品的特性，就像我通过讨论这些特性的有用性来获利一样。这个会扭曲我们的讨论吗？有可能的风险在利益冲突的地方，我将把它交给学术社区来获得结论
-   我的工作基于我过去的讨论，而有一些没有呈现在讨论中，可能导致结果不完整和版本扭曲。我想建议Cheriton和Skeen创造场合来看一下Isis的虚拟同步方面，讨论它们在CATOCS顺序中的价值。但他们指出这些问题包含顺序和可靠性的综合，且CATOCS是不适应的。特别地，他们引入交易强烈建议CATOCS主要支持交易应用程序的构建
-   即使把Cheriton和Skeen的论文放在它固有的地方，呈现地争论通常也是不完整的，因此有误导。例如，当这些作者引入纯顺序问题，他们通过使用应用程序特定语义顺序属性。其相信典型用户有相同的顺序目标集，系统的意图是实现用户的编程模型。事实是顺序问题通常导致编程风格包含异步通讯，系统主要的原因是担心消息顺序会减少用户可见设计复杂度且因此增加可靠性
-   一些争议很激烈，比如CATOCS不能维持一致“弹性”数据结构，且声称在缓存空间跟系统大小的函数一样的二次方增长，是错误的。在这方面，Cheriton和Skeen的二次方增长现象在典型Isis消息上对应一些字节的时间戳，即使对非常大的进程组平均也许只是12字节的数据。特殊进程的必要负载也相似地较低。这样的负载分析，及一些其他，跟系统像Isis、Transis、Psync、Gossiphe和Amoeba的经验直接矛盾
-   在操作系统社区，性能是一个重要的考虑因素。而Cheriton和Skeen声称CATOCS成本高，他们没有说他们喜欢的交易一致性模型的成本。一致性需要的地方，Isis虚拟同步模型 - 他们没有提及 - 考虑更好的交易和给出强保证除了外带数据。更进一步，我们可容易的在Isis上分层交易，或把它们靠近Isis。这样有三个选择：一个编程模型运行尽可能快，但没有语义（希望用户不会构建一些东西来引入可靠性或一致性），一个进程组编程模型，其可拷贝数据且有其他的一致顺序、容错编程工具，且在CATOCS系统属性中有一个键有非常高的性能，和交易模型，其性能不可避免地被刷新日志到稳定存储成本的限制。通过忽略虚拟同步的引用，Cheriton和Skeen用他们的偏见来支持他们想要得到的结论

这不是秘密，我相信在提供无关和总序的争论上，至少在进程组计算系统中是被排斥的。一个主要原因，Cheriton和Skeen没有谈到，是这种处理（至少当嵌入到一个适当的编程环境）在实现分布式系统中会极大减少复杂度，开发时间和调试效果。我相信甚至有时发生小的性能损失，平均用户更关心有一个简单的方式构建可靠软件而不是在应用程序中有一个通讯协议属性的总控制。Cheriton和Skeen忽略了简单化的收益，标准和处理开发人员失控的困难问题

这种观点有争议也不是个秘密。为挑战它，Cheriton和Skeen收集了一些不需要Isis提供的系统（他们声称他们的例子取材于文献，但大多数跟我了解的论文里的例子非常不同）。他们丢失了Isis发展的整个系统类。为对应他们引入的可靠性问题，他们这么做而不提及Isis虚拟同步模型这个关键的方面，导致他们得到结论“CATOCS顺序属性对这些问题是不适应的“。Isis处理比CATOCS顺序属性更能容忍可靠性问题，这个观点被Cheriton和Skeen完全忽略。这个的一个好例子是由于原子多播协议不一致的输出导致无关离开分割的失败。Isis防止了这个问题，而这在Cheriton和Skeen的处理中检测和处理都非常困难

为减少Isis相对于CATOCS的争议，Cheriton和Skeen简单丢弃了整个观点，当组合一个适当的执行模型，CATOCS是一个有价值的工具改善分布式系统性能和简化用户编程环境。也许CATOCS顺序限制了RPC编程在不一致的情况下的价值，或在纯交易环境中。但在这些极端依赖高可用性、高性能和一致性的分布式计算模型中，提供给开发者的选项在其他情况下并不有效


<a id="org537de57"></a>

## 实际中的经验

Cheriton和Skeen的论文主要用在学术领域，我想做对应的事。作者提及了TIB商业上的成功，Teknekron产品。论文的几个部分引用了来自TIB用户的反馈。我想指出Isis也是一个商业成功产品，且我也能从我的用户中得到相同的反馈。事实上，我能强烈地得到在目前写作期间Isis比TIB更成功

Isis用在市场数据应用程序，且被用于一些有野心的金融系统，比如纽约股票交易所的内部通讯基础设施，EBS的通讯层，其为超过60个瑞士银行和货币交易公司组成的联盟发展的一套电子交易系统。Isis在其他领域也有成功的案例。例如，Isis被用在通信系统，工厂级自动系统（进程控制和电子制作），计算机辅助设计和工程、科学计算（新CERN粒子加速器的数据获取系统） - 这只是各种分布式系统需求的表面。更进一步，Isis被选中作为主要的军事项目，比如HiperD系统（AEGIS系统的前身），下一代手机系统（Iridium），及用于空中交通管制

很可能的，Cheriton和Skeen会反馈说这种用户没有他们的应用程序需要CATCOS顺序的证据；也许他们需要容错或Isis的其他方面，也许Isis价格排斥他们，或也许这些用户是错误的且可以用TIB管理。当然，这些评论也可以用到Cheriton和Skeen提到的150个TIB用户

好的方式来引用现实世界中的应用程序是描述应用程序足够多的细节使得读者可看清楚一些系统属性，比如CATCOS顺序，如何解决问题。例如，纽约股票交易所担心在交易发生时保留关联顺序的成本，否则交易商不能意识到一系列事件。交易所也担心用同样的顺序显示相同的事件，避免给交易商一个非公平的优先级当其他交易商看到的是不同的显示的时候。且，在股票交易应用程序中是松散地实时限制。通过学习这些考量，我们可询问对底层消息传递系统提供关联和总序的价值如何


<a id="org9574eb8"></a>

# Tips

Probability Theory

<http://math.mit.edu/~goemans/18310S15/probability-notes.pdf>


<a id="org78514ce"></a>

## 采样空间和事件

为处理概率，我们定义一个采样空间S，其元素为某些进程或实验可能的输出。例如，采样空间可能为一个骰子的输出，或抛硬币。对采样空间的每个元素，我们赋值一个概率，为0到1之间的非负数，我们记为p(x)，我们需要

$ \\sum_ {x \\in S}p(x) = 1 $

这样我们采样空间元素的总概率为1。这意味着当我们执行我们的进程，我们采样空间中的一个将发生

**例子** 采样空间可为 $ S = \\{a, b, c\\} $，且概率可为p(a) = 1/2, p(b) = 1/3, p(c) = 1/6

如果我们采样空间中的所有元素有相同的概率，我们称为我们采样空间中的统一概率分布。例如，如果我们采样空间为骰子输出，采样空间可记为 $ S = \\{x_ {1}, x_ {2}, \\ldots, x_ {6} \\} $，事件 $ x_ {i} $对应值i。统一分布，每个输出 $ x_ {i} $对应公平的骰子有1/6的概率。相似地，如果我们考虑抛一个公平的硬币，输出为H（头）和T（尾），每个概率为1/2。在这种情况下我们有统一概率分布S = {H, T}

我们定义一个事件A为采样空间的子集。例如，在投骰子中，如果事件A为偶数，则 $ A = \\{x_ {2}, x_ {4}, x_ {6} \\} $。事件A的概率记为 $ \\mathbb{P}(A) $，为采样空间对应元素概率的和。对此我们有

$ \\mathbb{P}(A) = p(x_ {2}) + p(x_ {4}) + p(x_ {6}) = \\frac{1}{2} $

给定一个我们采样空间中的事件A，有一个补事件对应采样空间中不在A中的所有点。我们记为事件 $ \\neg A $。因为采样空间所有点相加为1，我们有

$ \\mathbb{P}(A) + \\mathbb{P}(\\neg A) = \\sum_ {x \\in A}p(x) + \\sum_ {p \\notin A}p(x) = \\sum_ {x \\in S}p(x) = 1 $

这样 $ \\mathbb{P}(\\notin A) = 1 - \\mathbb{P}(A) $

注意：虽然我们采样空间的两个元素不能同时发生，两个事件可以同时发生。即，如果我们定义A为投出来为偶数，且B为投出来是小数（1，2或3），则它可能对A和B都发生（投出来是2）,都不发生（投出来是5），或其中一个发生。我们称A和B都发生为"A and B“，记为$ A \\land B $（或有时为 $ A \\cap B $），且事件A或B至少一个发生为"A or B"，记为 $ A \\lor B $（或有时为 $ A \\cup B $）

![img](../img/probability_of_events_A_and_B.png)

假设我们有两个事件A和B。他们分割我们的采样空间为4个不相交的部分，对应两个事件发生，一个事件发生另一个事件不发生和两个都不发生。如上图。这些情况覆盖了整个采样空间，对每个元素只发生一次，这样我们得到

$ \\mathbb{P}(A \\land B) + \\mathbb{P}(A \\land \\notin B) + \\mathbb{P}(\\notin A \\land B) + \\mathbb{P}(\\notin A \\land \\notin B) = 1 $


<a id="org809e364"></a>

## 条件概率和独立

设A为一个非零概率事件，我们定义事件B的概率以事件A为条件，记为 $ \\mathbb{P}(B \| A) $，为

$ \\mathbb{P}(B \| A) = \\frac{\\mathbb{P}(A \\land B)}{\\mathbb{P}(A)} $

为什么这是一个有趣的记号？让我们给一个例子。假设我们投一个骰子，且我们问投出奇数的可能性，在投出一个数最多为3的条件下？因为我们知道我们的投值为1，2和3，且它们概率上相等（因为我们是一个公平骰子的统一平均分布），则每个输出的概率为 $ \\frac{1}{3} $。这样获得奇数的概率（得到1或3）为 $ \\frac{2}{3} $。这样如果A是一个事件“输出最多为3“且B是“输出为奇数”，则我们有数学定义“基于条件A的B的概率“给定为 $ \\mathbb{P}(B \| A) = 2 / 3 $。有

$ \\mathbb{P}(B \| A) = \\frac{\\mathbb{P}(B \\land A)}{\\mathbb{P}(A)} = \\frac{2 / 6}{1 / 2} = \\frac{2}{3} $

我们定义 $ \\mathbb{P}(B \| A) $的直观原因给出了我们想要的答案，即当事件A的一个条件发生时A中每个输出的概率将乘以 $ \\frac{1}{\\mathbb{P}(A)} $

容易计算检查如果我们有两个事件A和B，则

$ \\mathbb{P}(A) = \\mathbb{P}(A \| B)\\mathbb{P}(B) + \\mathbb{P}(A \| \\notin B)\\mathbb{P}(\\notin B) $

其前一项为 $ \\mathbb{P}(A \\land B) $，后一项为 $ \\mathbb{P}(A \\land \\notin B) $。两项相加，得到

$ \\mathbb{P}(A \\land B) + \\mathbb{P}(A \\land \\notin B) = \\mathbb{P}(A) $

如果我们有两个事件A和B，我们说他们独立如果两个都发生的概率是两个事件概率的乘积，即

$ \\mathbb{P}(A \\land B) = \\mathbb{P}(A) \\cdot \\mathbb{P}(B) $

**例子** 对一个骰子，投出偶数的事件A，和投出小于等于3的事件B是不独立的，因为 $ \\mathbb{P}(A) \\cdot \\mathbb{P}(B) \\ne \\mathbb{P}(A \\land B) $。即 $ \\frac{1}{2} \\cdot \\frac{1}{2} \\ne \\frac{1}{6} $。然而，如果你定义C为投出1或2的事件，则A和C是独立的，因为 $ \\mathbb{P}(A) = \\frac{1}{2}, \\mathbb{P}(C) = \\frac{1}{3}, \\mathbb{P}(A \\land C) = \\frac{1}{6} $

让我们现在显示在一个例子上独立的数学定义跟直观的独立定义不匹配。让我们假设我们扔两个硬币（不需要公平的硬币）。采样空间 $ S = \\{HH, HT, TH, TT\\} $（前一个字母代表第一个硬币的结果）。让我们记第一个硬币为尾的事件为 $ T \\circ $，第二个硬币为尾的事件为 $ \\circ T $。通过定义，我们有 $ \\mathbb{P}(T \\circ) = p(TH) + p(TT) $。假设知道第一个硬币为尾不改变第二个硬币为尾的概率。这给出

$ \\mathbb{P}(\\circ T \| T \\circ) = \\mathbb{P}(\\circ T) $

更进一步，通过条件概率的定义，

$ \\mathbb{P}(\\circ T \| T \\circ) = \\frac{\\mathbb{P}(TT)}{\\mathbb{P}(T \\circ)} $

通过组合得到

$ \\mathbb{P}(TT) = \\mathbb{P}(T \\circ) \\mathbb{P}(\\circ T) $

或对应的

$ \\mathbb{P}(T \\circ \\land \\circ T) = \\mathbb{P}(T \\circ) \\mathbb{P}(\\circ T) $

该式为独立的定义。结论：知道第一额硬币是尾不改变第二个硬币是尾的概率，这跟我们定义事件 $ T \\circ $和 $ \\circ T $独立是相同的

更一般地，假设A和B独立，我们有

$ \\mathbb{P}(B \| A) = \\frac{\\mathbb{P}(A \\land B)}{\\mathbb{P}(A)} = \\frac{\\mathbb{P}(A) \\mathbb{P}(B)}{\\mathbb{P}(A)} = \\mathbb{P}(B) $

即如果两个事件独立，则B发生的概率，基于条件A发生跟B发生的概率没有条件时相同。它直接检查推理可保留：如果B的概率在A条件下不改变，则两个事件独立


<a id="org63e202f"></a>

# Share

Binary Decision Diagrams

<https://crypto.stanford.edu/pbc/notes/zdd/>

看一张美国大陆的地图，考虑如下问题：

假设你想要通过高速公路访问每个州立法机构一次，怎样才是最短？怎样才是最长？所有路的平均方差和标准方差是什么？

定义州的权重，例如，通过读前两个字母作为以36为基的数。找到州的集合使得集合中没有两个元素相邻，且总权重最大

有一些方法对地图着色使得相邻的州不会有相同的颜色。如果颜色有权重2，3，5和7，怎样着色有最少的权重？

或考虑：

你如何覆盖棋盘使用 $ 1 \\times 1, 2 \\times 1, 3 \\times 1 $方框？如果我们也有类似 $ 2 \\times 2 $的方盒其中一块丢失？

列出所有5字母单词，其替代一个b为o仍然是单词

我们如何有效地解决这些问题？


<a id="org85770dc"></a>

## Families and ZDDs

拿第二个地图问题作为例子。设U为所有美国大陆州的集合。任何不相邻州的选择可被视为U的子集

考虑F，所有这些子集的集合。为清晰化，我们称U的子集的集合比如F（对应的，U的幂集的子集）为U上的集合族。这样“集合”通常表示为U的一个子集，且族意味着这些子集的聚合。hypergraphs对应集合族，但我们跟从高纳德的推荐用族

证明我们可描述F为基本族，如果我们有一个更聪明的方法在计算机上来表征族，我们可能快速构建从基本族到F的表征，并确定集合在F中的最大权重，并解决该问题

一个ZDD是一个聪明的数据结构表征一个集合族。ZDD代表零抑制二进制决策表格但它不重要

如上的组合问题可被视为特殊族集合问题。用ZDD，我们可高效的给出答案


<a id="org4b7cf33"></a>

## References

看

-   Donald E. Knuth, "The Art of Computer Programming", Volume 4, Fascicle 1
-   Computer Musings by Professor Donald E. Knuth, in particular, "Fun With Zero-Suppressed Binary Decision Diagrams (ZDDs)" and "Fun With Binary Decision Diagrams (BDDs)"

粗略来说，许多元素的成员关系相关时BDD比ZDD要好，无关时ZDD好。我聚焦于ZDD，因为当我开始这些笔记时我感兴趣的问题更适合ZDD

我想知道如果任何人看到一些BDD-ZDD混合，其每条边包含一个比特位表示它是否应该解释为BDD边或ZDD边。我怀疑相关算法可工作在一个BDD混合中，且获得两全其美有助于解决某些问题。也许我们可进一步定义某些问题的边尾，例如，一个在i和j之间的边意味着每第二个在i和j之间的元素必须在，且另一个类型的边可能意味着在范围内的只有一个元素在

